
FILE(MAKE_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0")
IF(WIN32)
    EXEC_PROGRAM(cmake "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0" ARGS -G \"MinGW Makefiles\" -DVTK_QT_VERSION:STRING=5 -DVTK_Group_Qt:BOOL=ON -DBUILD_SHARED_LIBS:BOOL=ON -DCMAKE_INSTALL_PREFIX=\"${CMAKE_SOURCE_DIR}/6.3.0\" \"${CMAKE_SOURCE_DIR}/src/VTK-6.3.0\")
ELSE()
    EXEC_PROGRAM(cmake "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0" ARGS -DVTK_QT_VERSION:STRING=5 -DVTK_Group_Qt:BOOL=ON -DBUILD_SHARED_LIBS:BOOL=ON -DCMAKE_INSTALL_PREFIX=\"${CMAKE_SOURCE_DIR}/6.3.0\" \"${CMAKE_SOURCE_DIR}/src/VTK-6.3.0\")
ENDIF()

INCLUDE(ProcessorCount)
ProcessorCount(N)

IF(WIN32)
    IF(NOT N EQUAL 0)
        ADD_CUSTOM_TARGET(vtk ALL mingw32-make install -j4 WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0")
    ELSE()
        ADD_CUSTOM_TARGET(vtk ALL mingw32-make install WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0")
    ENDIF()

    # FIXME
    INSTALL(CODE "exec_program(mingw32-make install \"${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0\" ARGS install)")
ELSE()
    IF(NOT N EQUAL 0)
        ADD_CUSTOM_TARGET(vtk ALL make install -j4 WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0")
    ELSE()
        ADD_CUSTOM_TARGET(vtk ALL make install WORKING_DIRECTORY "${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0")
    ENDIF()

    # FIXME
    INSTALL(CODE "exec_program(make install \"${CMAKE_CURRENT_SOURCE_DIR}/VTK-6.3.0\" ARGS install)")
ENDIF()

